<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta
    name="google-site-verification"
    content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI"
  />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, viewport-fit=cover"
  />
  <meta name="description" content="cody1991的博客" />
  <meta name="keywords" content="cody1991, blog" />
  <meta name="theme-color" content="#000000" />

  <!-- Open Graph -->
  <meta
    property="og:title"
    content="Vue3 + TypeScript + Vuex4 初尝试 - cody1991的博客 | cody1991 Blog"
  />
  
  <meta property="og:type" content="article" />
  <meta
    property="og:description"
    content="一个简单的任务列表构建，本文的代码在 vue3-typescript 可自行下载
"
  />
   <meta property="article:published_time" content="2021-03-20T00:00:00Z">   
  <meta property="article:tag" content="Vue" />
   
  <meta property="og:image" content="https://cody1991.github.io/Bloghttps://cody1991.github.io/Blog/img/cody1991.jpeg" />
  <meta property="og:url" content="https://cody1991.github.io/Blog/2021/03/20/vue3-ts-list/" />
  <meta property="og:site_name" content="cody1991的博客 | cody1991 Blog" />

  <title>
    Vue3 + TypeScript + Vuex4 初尝试 - cody1991的博客 | cody1991 Blog
  </title>

  <!-- Web App Manifest -->
  <link rel="manifest" href="/Blog/pwa/manifest.json" />

  <!-- Favicon -->
  <link rel="shortcut icon" href="/Blog/img/favicon.ico" />

  <!-- Canonical URL -->
  <link
    rel="canonical"
    href="https://cody1991.github.io/Blog/Blog/2021/03/20/vue3-ts-list/"
  />

  <!-- Bootstrap Core CSS -->
  <link
    rel="stylesheet"
    href="//cdn.bootcdn.net/ajax/libs/twitter-bootstrap/3.3.2/css/bootstrap.min.css"
  />

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/Blog/css/hux-blog.css">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/Blog/css/codytang-blog.css">

  <!-- Custom Fonts -->
  <!-- <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
  <!-- Hux change font-awesome CDN to qiniu -->
  <link
    href="//cdn.bootcdn.net/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css"
    rel="stylesheet"
    type="text/css"
  />

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->

  <!-- ga & ba script hoook -->
  <script></script>

  <script>
    (function () {
      var src = '//cdn.jsdelivr.net/npm/eruda';
      if (
        !/eruda=true/.test(window.location) &&
        localStorage.getItem('active-eruda') != 'true'
      )
        return;
      document.write('<scr' + 'ipt src="' + src + '"></scr' + 'ipt>');
      document.write('<scr' + 'ipt>eruda.init();</scr' + 'ipt>');
    })();
  </script>
</head>


  <!-- hack iOS CSS :active style -->
  <body ontouchstart="">
    <!-- Navigation -->

    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/Blog/">cody1991</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div id="huxblog_navbar">
                <div class="navbar-collapse">
                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="/Blog/">Home</a>
                        </li>
                        
                        
                        
                        
                        <li>
                            <a href="/Blog/about/">About</a>
                        </li>
                        
                        
                        
                        <li>
                            <a href="/Blog/archive/">Archive</a>
                        </li>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <li class="search-icon">
                            <a href="javascript:void(0)">
                                <i class="fa fa-search"></i>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <script>
        // Drop Bootstarp low-performance Navbar
        // Use customize navbar with high-quality material design animation
        // in high-perf jank-free CSS3 implementation
        var $body = document.body;
        var $toggle = document.querySelector('.navbar-toggle');
        var $navbar = document.querySelector('#huxblog_navbar');
        var $collapse = document.querySelector('.navbar-collapse');

        var __HuxNav__ = {
            close: function () {
                $navbar.className = " ";
                // wait until animation end.
                setTimeout(function () {
                    // prevent frequently toggle
                    if ($navbar.className.indexOf('in') < 0) {
                        $collapse.style.height = "0px"
                    }
                }, 400)
            },
            open: function () {
                $collapse.style.height = "auto"
                $navbar.className += " in";
            }
        }

        // Bind Event
        $toggle.addEventListener('click', function (e) {
            if ($navbar.className.indexOf('in') > 0) {
                __HuxNav__.close()
            } else {
                __HuxNav__.open()
            }
        })

        /**
         * Since Fastclick is used to delegate 'touchstart' globally
         * to hack 300ms delay in iOS by performing a fake 'click',
         * Using 'e.stopPropagation' to stop 'touchstart' event from 
         * $toggle/$collapse will break global delegation.
         * 
         * Instead, we use a 'e.target' filter to prevent handler
         * added to document close HuxNav.  
         *
         * Also, we use 'click' instead of 'touchstart' as compromise
         */
        document.addEventListener('click', function (e) {
            if (e.target == $toggle) return;
            if (e.target.className == 'icon-bar') return;
            __HuxNav__.close();
        })
    </script> <!-- Search -->
<div class="search-page">
  <div class="search-icon-close-container">
    <span class="search-icon-close">
      <i class="fa fa-chevron-down"></i>
    </span>
  </div>
  <div class="search-main container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <form></form>
        <input type="text" id="search-input" placeholder="$ grep...">
        </form>
        <div id="search-results" class="mini-post-list"></div>
      </div>
    </div>
  </div>
</div> <!-- Image to hack wechat -->
<!-- <img src="/img/icon_wechat.png" width="0" height="0"> -->
<!-- <img src="/Blog/img/home-bg.jpg" width="0" height="0"> -->

<!-- Post Header -->



<style type="text/css">
    header.intro-header{
        position: relative;
        background-image: url('/Blog/img/home-bg.jpg');
        background: ;
    }

    
</style>

<header class="intro-header" >

    <div class="header-mask"></div>
    
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/Blog/archive/?tag=Vue" title="Vue">Vue</a>
                        
                    </div>
                    <h1>Vue3 + TypeScript + Vuex4 初尝试</h1>
                    
                    <h2 class="subheading"></h2>
                    <span class="meta">Posted by cody1991 on March 20, 2021</span>
                </div>
            </div>
        </div>
    </div>
</header>






<!-- Post Content -->
<article>
  <div class="container">
    <div class="row">
      <!-- Post Container -->
      <div
        class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 post-container"
      >
        <!-- Multi-Lingual -->
         <p>一个简单的任务列表构建，本文的代码在 <a href="https://github.com/cody1991/vue3-typescript">vue3-typescript</a> 可自行下载</p>

<h1 id="准备工作">准备工作</h1>

<p>使用 Vue CLI 脚手架工具快速创建项目</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>yarn global add @vue/cli

vue create vue3-ts
</pre></td></tr></tbody></table></code></pre></div></div>

<p>手动选择我们想要的配置</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>Vue CLI v4.5.12
? Please pick a preset: Manually <span class="k">select </span>features
? Check the features needed <span class="k">for </span>your project: Choose Vue version, Babel, TS, Vuex, Linter
? Choose a version of Vue.js that you want to start the project with 3.x <span class="o">(</span>Preview<span class="o">)</span>
? Use class-style component syntax? No
? Use Babel alongside TypeScript <span class="o">(</span>required <span class="k">for </span>modern mode, auto-detected polyfills, transpiling JSX<span class="o">)</span>? Yes
? Pick a linter / formatter config: Basic
? Pick additional lint features: Lint on save
? Where <span class="k">do </span>you prefer placing config <span class="k">for </span>Babel, ESLint, etc.? In dedicated config files
? Save this as a preset <span class="k">for </span>future projects? No
</pre></td></tr></tbody></table></code></pre></div></div>

<p>之后进入到我们的 <code class="language-plaintext highlighter-rouge">vue3-ts</code> 文件夹运行 <code class="language-plaintext highlighter-rouge">yarn serve</code> 就可以启动项目了，看到我们熟悉的界面</p>

<p><img src="/img/posts/vue3-ts-1.png" alt="" /></p>

<p>接着安装我们的 <code class="language-plaintext highlighter-rouge">UI</code> 库，并不想自己写样式。。</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>yarn add bulma
</pre></td></tr></tbody></table></code></pre></div></div>

<p>调整下 <code class="language-plaintext highlighter-rouge">App.vue</code> 文件，引入 <code class="language-plaintext highlighter-rouge">bulma</code></p>

<div class="language-vue highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;</span><span class="k">template</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div&gt;</span>App<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/</span><span class="k">template</span><span class="nt">&gt;</span>

<span class="nt">&lt;</span><span class="k">script</span> <span class="na">lang=</span><span class="s">"ts"</span><span class="nt">&gt;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">defineComponent</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vue</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">defineComponent</span><span class="p">({</span>
  <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">App</span><span class="dl">'</span><span class="p">,</span>
<span class="p">});</span>
<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>

<span class="nt">&lt;</span><span class="k">style</span><span class="nt">&gt;</span>
<span class="k">@import</span> <span class="s2">'~bulma/css/bulma.css'</span><span class="p">;</span>
<span class="nt">&lt;/</span><span class="k">style</span><span class="nt">&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h1 id="需求明确">需求明确</h1>

<p>然后明确下我们这个项目的任务，其实就是增删改查任务，<code class="language-plaintext highlighter-rouge">CURD boy</code>~</p>

<h1 id="vuex">Vuex</h1>

<p><code class="language-plaintext highlighter-rouge">Vuex</code> 里面的四要素： <code class="language-plaintext highlighter-rouge">Store</code> <code class="language-plaintext highlighter-rouge">Getters</code> <code class="language-plaintext highlighter-rouge">Actions</code> <code class="language-plaintext highlighter-rouge">Mutations</code></p>

<p><code class="language-plaintext highlighter-rouge">States</code> 状态都存储在 <code class="language-plaintext highlighter-rouge">Store</code> 里面，我们只能同步通过 <code class="language-plaintext highlighter-rouge">Mutations</code> 去修改 <code class="language-plaintext highlighter-rouge">States</code>，异步修改 <code class="language-plaintext highlighter-rouge">States</code> 的话可以使用 <code class="language-plaintext highlighter-rouge">Actions</code> 在回调中调用 <code class="language-plaintext highlighter-rouge">Mutations</code> 修改 <code class="language-plaintext highlighter-rouge">States</code>，<code class="language-plaintext highlighter-rouge">Getters</code> 是方便获取 <code class="language-plaintext highlighter-rouge">States</code> 的一种手段，类似于 <code class="language-plaintext highlighter-rouge">Computed</code></p>

<p>开始构建我们的 <code class="language-plaintext highlighter-rouge">Store</code> 吧～</p>

<h2 id="states">States</h2>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre></td><td class="rouge-code"><pre><span class="c1">// store/state.ts</span>
<span class="k">export</span> <span class="kd">type</span> <span class="nx">TaskItem</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">id</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
  <span class="nl">title</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
  <span class="nl">description</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
  <span class="nl">createdBy</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
  <span class="nl">assignedTo</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
  <span class="nl">completed</span><span class="p">:</span> <span class="nx">boolean</span><span class="p">;</span>
  <span class="nl">editing</span><span class="p">:</span> <span class="nx">boolean</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">export</span> <span class="kd">type</span> <span class="nx">State</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">loading</span><span class="p">:</span> <span class="nx">boolean</span><span class="p">;</span>
  <span class="nl">tasks</span><span class="p">:</span> <span class="nx">TaskItem</span><span class="p">[];</span>
  <span class="nl">showCreateModal</span><span class="p">:</span> <span class="nx">boolean</span><span class="p">;</span>
  <span class="nl">showEditModal</span><span class="p">:</span> <span class="nx">boolean</span><span class="p">;</span>
  <span class="nl">editModalTaskId</span><span class="p">:</span> <span class="kr">number</span> <span class="o">|</span> <span class="kc">undefined</span><span class="p">;</span>
  <span class="nl">showTaskModal</span><span class="p">:</span> <span class="nx">boolean</span><span class="p">;</span>
  <span class="nl">showTaskId</span><span class="p">:</span> <span class="kr">number</span> <span class="o">|</span> <span class="kc">undefined</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">state</span><span class="p">:</span> <span class="nx">State</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">loading</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="na">tasks</span><span class="p">:</span> <span class="p">[],</span>
  <span class="na">showCreateModal</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="na">showEditModal</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="na">editModalTaskId</span><span class="p">:</span> <span class="kc">undefined</span><span class="p">,</span>
  <span class="na">showTaskModal</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="na">showTaskId</span><span class="p">:</span> <span class="kc">undefined</span><span class="p">,</span>
<span class="p">};</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>之后引入就好了</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="k">import</span> <span class="p">{</span> <span class="nx">createStore</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vuex</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">state</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./state</span><span class="dl">'</span><span class="p">;</span>
<span class="k">export</span> <span class="k">default</span> <span class="nx">createStore</span><span class="p">({</span>
  <span class="nx">state</span><span class="p">,</span>
  <span class="na">mutations</span><span class="p">:</span> <span class="p">{},</span>
  <span class="na">actions</span><span class="p">:</span> <span class="p">{},</span>
  <span class="na">modules</span><span class="p">:</span> <span class="p">{},</span>
<span class="p">});</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="mutations">Mutations</h2>

<p>之后编写下我们可以修改状态的方法。</p>

<ol>
  <li>编写我们需要修改状态的方法枚举值</li>
  <li>编写 <code class="language-plaintext highlighter-rouge">Mutations</code> 相关方法的类型定义</li>
  <li>实现 <code class="language-plaintext highlighter-rouge">Mutations</code> 相关方法</li>
</ol>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
</pre></td><td class="rouge-code"><pre><span class="k">import</span> <span class="p">{</span> <span class="nx">MutationTree</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vuex</span><span class="dl">'</span><span class="p">;</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">State</span><span class="p">,</span> <span class="nx">TaskItem</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./state</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kr">enum</span> <span class="nx">MutationType</span> <span class="p">{</span>
  <span class="nx">CreateTask</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">CREATE_TASK</span><span class="dl">'</span><span class="p">,</span>
  <span class="nx">SetTasks</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">SET_TASKS</span><span class="dl">'</span><span class="p">,</span>
  <span class="nx">CompleteTask</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">COMPLETE_TASK</span><span class="dl">'</span><span class="p">,</span>
  <span class="nx">RemoveTask</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">REMOVE_TASK</span><span class="dl">'</span><span class="p">,</span>
  <span class="nx">EditTask</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">EDIT_TASK</span><span class="dl">'</span><span class="p">,</span>
  <span class="nx">UpdateTask</span> <span class="o">=</span> <span class="s2">`UPDATE_TASK`</span><span class="p">,</span>
  <span class="nx">SetLoading</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">SET_LOADING</span><span class="dl">'</span><span class="p">,</span>
  <span class="nx">SetCreateModal</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">SET_CREATE_MODAL</span><span class="dl">'</span><span class="p">,</span>
  <span class="nx">SetEditModal</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">SET_EDIT_MODAL</span><span class="dl">'</span><span class="p">,</span>
  <span class="nx">SetTaskModal</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">SET_TASK_MODAL</span><span class="dl">'</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kd">type</span> <span class="nx">Mutations</span> <span class="o">=</span> <span class="p">{</span>
  <span class="p">[</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">CreateTask</span><span class="p">](</span><span class="na">state</span><span class="p">:</span> <span class="nx">State</span><span class="p">,</span> <span class="na">task</span><span class="p">:</span> <span class="nx">TaskItem</span><span class="p">):</span> <span class="k">void</span><span class="p">;</span>
  <span class="p">[</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">SetTasks</span><span class="p">](</span><span class="na">state</span><span class="p">:</span> <span class="nx">State</span><span class="p">,</span> <span class="na">tasks</span><span class="p">:</span> <span class="nx">TaskItem</span><span class="p">[]):</span> <span class="k">void</span><span class="p">;</span>
  <span class="p">[</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">CompleteTask</span><span class="p">](</span>
    <span class="na">state</span><span class="p">:</span> <span class="nx">State</span><span class="p">,</span>
    <span class="na">task</span><span class="p">:</span> <span class="nb">Partial</span><span class="o">&lt;</span><span class="nx">TaskItem</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="p">{</span>
      <span class="na">id</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">):</span> <span class="k">void</span><span class="p">;</span>
  <span class="p">[</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">RemoveTask</span><span class="p">](</span>
    <span class="na">state</span><span class="p">:</span> <span class="nx">State</span><span class="p">,</span>
    <span class="na">task</span><span class="p">:</span> <span class="nb">Partial</span><span class="o">&lt;</span><span class="nx">TaskItem</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="p">{</span>
      <span class="na">id</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">):</span> <span class="k">void</span><span class="p">;</span>
  <span class="p">[</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">EditTask</span><span class="p">](</span>
    <span class="na">state</span><span class="p">:</span> <span class="nx">State</span><span class="p">,</span>
    <span class="na">task</span><span class="p">:</span> <span class="nb">Partial</span><span class="o">&lt;</span><span class="nx">TaskItem</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="p">{</span>
      <span class="na">id</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">):</span> <span class="k">void</span><span class="p">;</span>
  <span class="p">[</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">UpdateTask</span><span class="p">](</span>
    <span class="na">state</span><span class="p">:</span> <span class="nx">State</span><span class="p">,</span>
    <span class="na">task</span><span class="p">:</span> <span class="nb">Partial</span><span class="o">&lt;</span><span class="nx">TaskItem</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="p">{</span>
      <span class="na">id</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">):</span> <span class="k">void</span><span class="p">;</span>
  <span class="p">[</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">SetLoading</span><span class="p">](</span><span class="na">state</span><span class="p">:</span> <span class="nx">State</span><span class="p">,</span> <span class="na">value</span><span class="p">:</span> <span class="nx">boolean</span><span class="p">):</span> <span class="k">void</span><span class="p">;</span>
  <span class="p">[</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">SetCreateModal</span><span class="p">](</span><span class="na">state</span><span class="p">:</span> <span class="nx">State</span><span class="p">,</span> <span class="na">value</span><span class="p">:</span> <span class="nx">boolean</span><span class="p">):</span> <span class="k">void</span><span class="p">;</span>
  <span class="p">[</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">SetEditModal</span><span class="p">](</span>
    <span class="na">state</span><span class="p">:</span> <span class="nx">State</span><span class="p">,</span>
    <span class="na">value</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">showModal</span><span class="p">:</span> <span class="nx">boolean</span><span class="p">;</span>
      <span class="nl">taskId</span><span class="p">:</span> <span class="kr">number</span> <span class="o">|</span> <span class="kc">undefined</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">):</span> <span class="k">void</span><span class="p">;</span>
  <span class="p">[</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">SetTaskModal</span><span class="p">](</span>
    <span class="na">state</span><span class="p">:</span> <span class="nx">State</span><span class="p">,</span>
    <span class="na">value</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">showModal</span><span class="p">:</span> <span class="nx">boolean</span><span class="p">;</span>
      <span class="nl">taskId</span><span class="p">:</span> <span class="kr">number</span> <span class="o">|</span> <span class="kc">undefined</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">):</span> <span class="k">void</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">mutations</span><span class="p">:</span> <span class="nx">MutationTree</span><span class="o">&lt;</span><span class="nx">State</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="nx">Mutations</span> <span class="o">=</span> <span class="p">{</span>
  <span class="p">[</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">CreateTask</span><span class="p">](</span><span class="na">state</span><span class="p">:</span> <span class="nx">State</span><span class="p">,</span> <span class="na">task</span><span class="p">:</span> <span class="nx">TaskItem</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">task</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="p">[</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">SetTasks</span><span class="p">](</span><span class="na">state</span><span class="p">:</span> <span class="nx">State</span><span class="p">,</span> <span class="na">tasks</span><span class="p">:</span> <span class="nx">TaskItem</span><span class="p">[])</span> <span class="p">{</span>
    <span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span> <span class="o">=</span> <span class="nx">tasks</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="p">[</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">CompleteTask</span><span class="p">](</span>
    <span class="na">state</span><span class="p">:</span> <span class="nx">State</span><span class="p">,</span>
    <span class="na">task</span><span class="p">:</span> <span class="nb">Partial</span><span class="o">&lt;</span><span class="nx">TaskItem</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="p">{</span>
      <span class="na">id</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">taskIndex</span> <span class="o">=</span> <span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">.</span><span class="nx">findIndex</span><span class="p">((</span><span class="nx">ele</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">ele</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="nx">task</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">taskIndex</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">[</span><span class="nx">taskIndex</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">...</span><span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">[</span><span class="nx">taskIndex</span><span class="p">],</span>
        <span class="p">...</span><span class="nx">task</span><span class="p">,</span>
      <span class="p">};</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="p">[</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">RemoveTask</span><span class="p">](</span>
    <span class="na">state</span><span class="p">:</span> <span class="nx">State</span><span class="p">,</span>
    <span class="na">task</span><span class="p">:</span> <span class="nb">Partial</span><span class="o">&lt;</span><span class="nx">TaskItem</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="p">{</span>
      <span class="na">id</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">taskIndex</span> <span class="o">=</span> <span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">.</span><span class="nx">findIndex</span><span class="p">((</span><span class="nx">ele</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">ele</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="nx">task</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">taskIndex</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">taskIndex</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="p">[</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">EditTask</span><span class="p">](</span>
    <span class="na">state</span><span class="p">:</span> <span class="nx">State</span><span class="p">,</span>
    <span class="na">task</span><span class="p">:</span> <span class="nb">Partial</span><span class="o">&lt;</span><span class="nx">TaskItem</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="p">{</span>
      <span class="na">id</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">taskIndex</span> <span class="o">=</span> <span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">.</span><span class="nx">findIndex</span><span class="p">((</span><span class="nx">ele</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">ele</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="nx">task</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">taskIndex</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">[</span><span class="nx">taskIndex</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">...</span><span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">[</span><span class="nx">taskIndex</span><span class="p">],</span>
        <span class="na">editing</span><span class="p">:</span> <span class="o">!</span><span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">[</span><span class="nx">taskIndex</span><span class="p">].</span><span class="nx">editing</span><span class="p">,</span>
      <span class="p">};</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">tasking editing</span><span class="dl">'</span><span class="p">,</span> <span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">[</span><span class="nx">taskIndex</span><span class="p">]);</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="p">[</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">UpdateTask</span><span class="p">](</span>
    <span class="na">state</span><span class="p">:</span> <span class="nx">State</span><span class="p">,</span>
    <span class="na">task</span><span class="p">:</span> <span class="nb">Partial</span><span class="o">&lt;</span><span class="nx">TaskItem</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="p">{</span>
      <span class="na">id</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">taskIndex</span> <span class="o">=</span> <span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">.</span><span class="nx">findIndex</span><span class="p">((</span><span class="nx">ele</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">ele</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="nx">task</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">taskIndex</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">[</span><span class="nx">taskIndex</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">...</span><span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">[</span><span class="nx">taskIndex</span><span class="p">],</span>
        <span class="p">...</span><span class="nx">task</span><span class="p">,</span>
      <span class="p">};</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="p">[</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">SetLoading</span><span class="p">](</span><span class="na">state</span><span class="p">:</span> <span class="nx">State</span><span class="p">,</span> <span class="na">value</span><span class="p">:</span> <span class="nx">boolean</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">state</span><span class="p">.</span><span class="nx">loading</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="p">[</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">SetCreateModal</span><span class="p">](</span><span class="na">state</span><span class="p">:</span> <span class="nx">State</span><span class="p">,</span> <span class="na">value</span><span class="p">:</span> <span class="nx">boolean</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">state</span><span class="p">.</span><span class="nx">showCreateModal</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="p">[</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">SetEditModal</span><span class="p">](</span>
    <span class="na">state</span><span class="p">:</span> <span class="nx">State</span><span class="p">,</span>
    <span class="na">value</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">showModal</span><span class="p">:</span> <span class="nx">boolean</span><span class="p">;</span>
      <span class="nl">taskId</span><span class="p">:</span> <span class="kr">number</span> <span class="o">|</span> <span class="kc">undefined</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">)</span> <span class="p">{</span>
    <span class="nx">state</span><span class="p">.</span><span class="nx">showEditModal</span> <span class="o">=</span> <span class="nx">value</span><span class="p">.</span><span class="nx">showModal</span><span class="p">;</span>
    <span class="nx">state</span><span class="p">.</span><span class="nx">editModalTaskId</span> <span class="o">=</span> <span class="nx">value</span><span class="p">.</span><span class="nx">taskId</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="p">[</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">SetTaskModal</span><span class="p">](</span>
    <span class="na">state</span><span class="p">:</span> <span class="nx">State</span><span class="p">,</span>
    <span class="na">value</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">showModal</span><span class="p">:</span> <span class="nx">boolean</span><span class="p">;</span>
      <span class="nl">taskId</span><span class="p">:</span> <span class="kr">number</span> <span class="o">|</span> <span class="kc">undefined</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">)</span> <span class="p">{</span>
    <span class="nx">state</span><span class="p">.</span><span class="nx">showTaskModal</span> <span class="o">=</span> <span class="nx">value</span><span class="p">.</span><span class="nx">showModal</span><span class="p">;</span>
    <span class="nx">state</span><span class="p">.</span><span class="nx">showTaskId</span> <span class="o">=</span> <span class="nx">value</span><span class="p">.</span><span class="nx">taskId</span><span class="p">;</span>
  <span class="p">},</span>
<span class="p">};</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>再在 <code class="language-plaintext highlighter-rouge">store/index.ts</code> 倒入就好了</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="k">import</span> <span class="p">{</span> <span class="nx">createStore</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vuex</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">state</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./state</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">mutations</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./mutations</span><span class="dl">'</span><span class="p">;</span>
<span class="k">export</span> <span class="k">default</span> <span class="nx">createStore</span><span class="p">({</span>
  <span class="nx">state</span><span class="p">,</span>
  <span class="nx">mutations</span><span class="p">,</span>
  <span class="na">actions</span><span class="p">:</span> <span class="p">{},</span>
  <span class="na">modules</span><span class="p">:</span> <span class="p">{},</span>
<span class="p">});</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="actions">Actions</h2>

<p>我们接下来编写 <code class="language-plaintext highlighter-rouge">Actions</code> 相关的方法</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
</pre></td><td class="rouge-code"><pre><span class="k">import</span> <span class="p">{</span> <span class="nx">ActionContext</span><span class="p">,</span> <span class="nx">ActionTree</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vuex</span><span class="dl">'</span><span class="p">;</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">Mutations</span><span class="p">,</span> <span class="nx">MutationType</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./mutations</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">State</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./state</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kr">enum</span> <span class="nx">ActionTypes</span> <span class="p">{</span>
  <span class="nx">GetTaskItems</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">GET_Task_ITEMS</span><span class="dl">'</span><span class="p">,</span>
  <span class="nx">SetCreateModal</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">SET_CREATE_MODAL</span><span class="dl">'</span><span class="p">,</span>
  <span class="nx">SetEditModal</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">SET_EDIT_MODAL</span><span class="dl">'</span><span class="p">,</span>
<span class="p">}</span>

<span class="kd">type</span> <span class="nx">ActionArguments</span> <span class="o">=</span> <span class="nx">Omit</span><span class="o">&lt;</span><span class="nx">ActionContext</span><span class="o">&lt;</span><span class="nx">State</span><span class="p">,</span> <span class="nx">State</span><span class="o">&gt;</span><span class="p">,</span> <span class="dl">'</span><span class="s1">commit</span><span class="dl">'</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="p">{</span>
  <span class="nx">commit</span><span class="o">&lt;</span><span class="nx">K</span> <span class="kd">extends</span> <span class="kr">keyof</span> <span class="nx">Mutations</span><span class="o">&gt;</span><span class="p">(</span>
    <span class="na">key</span><span class="p">:</span> <span class="nx">K</span><span class="p">,</span>
    <span class="na">payload</span><span class="p">:</span> <span class="nx">Parameters</span><span class="o">&lt;</span><span class="nx">Mutations</span><span class="p">[</span><span class="nx">K</span><span class="p">]</span><span class="o">&gt;</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
  <span class="p">):</span> <span class="nx">ReturnType</span><span class="o">&lt;</span><span class="nx">Mutations</span><span class="p">[</span><span class="nx">K</span><span class="p">]</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">export</span> <span class="kd">type</span> <span class="nx">Actions</span> <span class="o">=</span> <span class="p">{</span>
  <span class="p">[</span><span class="nx">ActionTypes</span><span class="p">.</span><span class="nx">GetTaskItems</span><span class="p">](</span><span class="na">context</span><span class="p">:</span> <span class="nx">ActionArguments</span><span class="p">):</span> <span class="k">void</span><span class="p">;</span>
  <span class="p">[</span><span class="nx">ActionTypes</span><span class="p">.</span><span class="nx">SetCreateModal</span><span class="p">](</span><span class="na">context</span><span class="p">:</span> <span class="nx">ActionArguments</span><span class="p">):</span> <span class="k">void</span><span class="p">;</span>
  <span class="p">[</span><span class="nx">ActionTypes</span><span class="p">.</span><span class="nx">SetEditModal</span><span class="p">](</span><span class="na">context</span><span class="p">:</span> <span class="nx">ActionArguments</span><span class="p">):</span> <span class="k">void</span><span class="p">;</span>
<span class="p">};</span>

<span class="kd">const</span> <span class="nx">sleep</span> <span class="o">=</span> <span class="p">(</span><span class="nx">ms</span><span class="p">:</span> <span class="kr">number</span><span class="p">)</span> <span class="o">=&gt;</span>
  <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">res</span><span class="p">(</span><span class="kc">true</span><span class="p">),</span> <span class="nx">ms</span><span class="p">));</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">actions</span><span class="p">:</span> <span class="nx">ActionTree</span><span class="o">&lt;</span><span class="nx">State</span><span class="p">,</span> <span class="nx">State</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="nx">Actions</span> <span class="o">=</span> <span class="p">{</span>
  <span class="k">async</span> <span class="p">[</span><span class="nx">ActionTypes</span><span class="p">.</span><span class="nx">GetTaskItems</span><span class="p">]({</span> <span class="nx">commit</span> <span class="p">})</span> <span class="p">{</span>
    <span class="nx">commit</span><span class="p">(</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">SetLoading</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="k">await</span> <span class="nx">sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
    <span class="nx">commit</span><span class="p">(</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">SetLoading</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>

    <span class="nx">commit</span><span class="p">(</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">SetTasks</span><span class="p">,</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="na">id</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="na">title</span><span class="p">:</span> <span class="dl">'</span><span class="s1">learn Vue3 + TypeScript + Vuex4</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">description</span><span class="p">:</span> <span class="dl">'</span><span class="s1">good good study, day day up</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">createdBy</span><span class="p">:</span> <span class="dl">'</span><span class="s1">codytang</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">assignedTo</span><span class="p">:</span> <span class="dl">'</span><span class="s1">codytang</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">completed</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="na">editing</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="na">id</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="na">title</span><span class="p">:</span> <span class="dl">'</span><span class="s1">miaomiaomiao</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">description</span><span class="p">:</span> <span class="dl">'</span><span class="s1">喵咪～～～</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">createdBy</span><span class="p">:</span> <span class="dl">'</span><span class="s1">🐱</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">assignedTo</span><span class="p">:</span> <span class="dl">'</span><span class="s1">🐱</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">completed</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="na">editing</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="p">},</span>
    <span class="p">]);</span>
  <span class="p">},</span>
  <span class="p">[</span><span class="nx">ActionTypes</span><span class="p">.</span><span class="nx">SetCreateModal</span><span class="p">]({</span> <span class="nx">commit</span> <span class="p">})</span> <span class="p">{</span>
    <span class="nx">commit</span><span class="p">(</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">SetCreateModal</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="p">[</span><span class="nx">ActionTypes</span><span class="p">.</span><span class="nx">SetEditModal</span><span class="p">]({</span> <span class="nx">commit</span> <span class="p">})</span> <span class="p">{</span>
    <span class="nx">commit</span><span class="p">(</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">SetEditModal</span><span class="p">,</span> <span class="p">{</span>
      <span class="na">showModal</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="na">taskId</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">});</span>
  <span class="p">},</span>
<span class="p">};</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>再在 <code class="language-plaintext highlighter-rouge">store/index.ts</code> 倒入就好了</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="k">import</span> <span class="p">{</span> <span class="nx">createStore</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vuex</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">state</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./state</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">mutations</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./mutations</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">actions</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./actions</span><span class="dl">'</span><span class="p">;</span>
<span class="k">export</span> <span class="k">default</span> <span class="nx">createStore</span><span class="p">({</span>
  <span class="nx">state</span><span class="p">,</span>
  <span class="nx">mutations</span><span class="p">,</span>
  <span class="nx">actions</span><span class="p">,</span>
  <span class="na">modules</span><span class="p">:</span> <span class="p">{},</span>
<span class="p">});</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="getters">Getters</h2>

<p>我们定义几个 <code class="language-plaintext highlighter-rouge">Getters</code> 辅助函数帮助我们快速获取一些值</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre><span class="k">import</span> <span class="p">{</span> <span class="nx">GetterTree</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vuex</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">State</span><span class="p">,</span> <span class="nx">TaskItem</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./state</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">type</span> <span class="nx">Getters</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">completedTaskCount</span><span class="p">(</span><span class="na">state</span><span class="p">:</span> <span class="nx">State</span><span class="p">):</span> <span class="kr">number</span><span class="p">;</span>
  <span class="nx">totalTaskCount</span><span class="p">(</span><span class="na">state</span><span class="p">:</span> <span class="nx">State</span><span class="p">):</span> <span class="kr">number</span><span class="p">;</span>
  <span class="nx">getTaskById</span><span class="p">(</span><span class="na">state</span><span class="p">:</span> <span class="nx">State</span><span class="p">):</span> <span class="p">(</span><span class="na">id</span><span class="p">:</span> <span class="kr">number</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">TaskItem</span> <span class="o">|</span> <span class="kc">undefined</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">getters</span><span class="p">:</span> <span class="nx">GetterTree</span><span class="o">&lt;</span><span class="nx">State</span><span class="p">,</span> <span class="nx">State</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="nx">Getters</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">completedTaskCount</span><span class="p">(</span><span class="na">state</span><span class="p">:</span> <span class="nx">State</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">item</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">item</span><span class="p">.</span><span class="nx">completed</span><span class="p">).</span><span class="nx">length</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="nx">totalTaskCount</span><span class="p">(</span><span class="na">state</span><span class="p">:</span> <span class="nx">State</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="na">getTaskById</span><span class="p">:</span> <span class="p">(</span><span class="na">state</span><span class="p">:</span> <span class="nx">State</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="na">id</span><span class="p">:</span> <span class="kr">number</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">.</span><span class="nx">find</span><span class="p">((</span><span class="nx">task</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">task</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="nx">id</span><span class="p">);</span>
  <span class="p">},</span>
<span class="p">};</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>再在 <code class="language-plaintext highlighter-rouge">store/index.ts</code> 倒入就好了</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="k">import</span> <span class="p">{</span> <span class="nx">createStore</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vuex</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">state</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./state</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">mutations</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./mutations</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">actions</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./actions</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">getters</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./getters</span><span class="dl">'</span><span class="p">;</span>
<span class="k">export</span> <span class="k">default</span> <span class="nx">createStore</span><span class="p">({</span>
  <span class="nx">state</span><span class="p">,</span>
  <span class="nx">mutations</span><span class="p">,</span>
  <span class="nx">actions</span><span class="p">,</span>
  <span class="nx">getters</span><span class="p">,</span>
  <span class="na">modules</span><span class="p">:</span> <span class="p">{},</span>
<span class="p">});</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>基本的几个要素都齐全了，我们再来修改下我们的 <code class="language-plaintext highlighter-rouge">Store</code></p>

<h2 id="store">Store</h2>

<p>调整成为下面这样</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
</pre></td><td class="rouge-code"><pre><span class="k">import</span> <span class="p">{</span>
  <span class="nx">createStore</span><span class="p">,</span>
  <span class="nx">Store</span> <span class="k">as</span> <span class="nx">VuexStore</span><span class="p">,</span>
  <span class="nx">CommitOptions</span><span class="p">,</span>
  <span class="nx">DispatchOptions</span><span class="p">,</span>
  <span class="nx">createLogger</span><span class="p">,</span>
<span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vuex</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">State</span><span class="p">,</span> <span class="nx">state</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./state</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Mutations</span><span class="p">,</span> <span class="nx">mutations</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./mutations</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Actions</span><span class="p">,</span> <span class="nx">actions</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./actions</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Getters</span><span class="p">,</span> <span class="nx">getters</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./getters</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">store</span> <span class="o">=</span> <span class="nx">createStore</span><span class="o">&lt;</span><span class="nx">State</span><span class="o">&gt;</span><span class="p">({</span>
  <span class="na">plugins</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">NODE_ENV</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">development</span><span class="dl">'</span> <span class="p">?</span> <span class="p">[</span><span class="nx">createLogger</span><span class="p">()]</span> <span class="p">:</span> <span class="p">[],</span>
  <span class="nx">state</span><span class="p">,</span>
  <span class="nx">mutations</span><span class="p">,</span>
  <span class="nx">actions</span><span class="p">,</span>
  <span class="nx">getters</span><span class="p">,</span>
  <span class="na">modules</span><span class="p">:</span> <span class="p">{},</span>
<span class="p">});</span>

<span class="k">export</span> <span class="kd">function</span> <span class="nx">useStore</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">store</span> <span class="k">as</span> <span class="nx">Store</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kd">type</span> <span class="nx">Store</span> <span class="o">=</span> <span class="nx">Omit</span><span class="o">&lt;</span>
  <span class="nx">VuexStore</span><span class="o">&lt;</span><span class="nx">State</span><span class="o">&gt;</span><span class="p">,</span>
  <span class="dl">'</span><span class="s1">getters</span><span class="dl">'</span> <span class="o">|</span> <span class="dl">'</span><span class="s1">commit</span><span class="dl">'</span> <span class="o">|</span> <span class="dl">'</span><span class="s1">dispatch</span><span class="dl">'</span>
<span class="o">&gt;</span> <span class="o">&amp;</span> <span class="p">{</span>
  <span class="nx">commit</span><span class="o">&lt;</span><span class="nx">K</span> <span class="kd">extends</span> <span class="kr">keyof</span> <span class="nx">Mutations</span><span class="p">,</span> <span class="nx">P</span> <span class="kd">extends</span> <span class="nx">Parameters</span><span class="o">&lt;</span><span class="nx">Mutations</span><span class="p">[</span><span class="nx">K</span><span class="p">]</span><span class="o">&gt;</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;</span><span class="p">(</span>
    <span class="na">key</span><span class="p">:</span> <span class="nx">K</span><span class="p">,</span>
    <span class="na">payload</span><span class="p">:</span> <span class="nx">P</span><span class="p">,</span>
    <span class="nx">options</span><span class="p">?:</span> <span class="nx">CommitOptions</span>
  <span class="p">):</span> <span class="nx">ReturnType</span><span class="o">&lt;</span><span class="nx">Mutations</span><span class="p">[</span><span class="nx">K</span><span class="p">]</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">}</span> <span class="o">&amp;</span> <span class="p">{</span>
  <span class="nx">dispatch</span><span class="o">&lt;</span><span class="nx">K</span> <span class="kd">extends</span> <span class="kr">keyof</span> <span class="nx">Actions</span><span class="o">&gt;</span><span class="p">(</span>
    <span class="na">key</span><span class="p">:</span> <span class="nx">K</span><span class="p">,</span>
    <span class="nx">payload</span><span class="p">?:</span> <span class="nx">Parameters</span><span class="o">&lt;</span><span class="nx">Actions</span><span class="p">[</span><span class="nx">K</span><span class="p">]</span><span class="o">&gt;</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="nx">options</span><span class="p">?:</span> <span class="nx">DispatchOptions</span>
  <span class="p">):</span> <span class="nx">ReturnType</span><span class="o">&lt;</span><span class="nx">Actions</span><span class="p">[</span><span class="nx">K</span><span class="p">]</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">}</span> <span class="o">&amp;</span> <span class="p">{</span>
  <span class="na">getters</span><span class="p">:</span> <span class="p">{</span>
    <span class="p">[</span><span class="nx">K</span> <span class="k">in</span> <span class="kr">keyof</span> <span class="nx">Getters</span><span class="p">]:</span> <span class="nx">ReturnType</span><span class="o">&lt;</span><span class="nx">Getters</span><span class="p">[</span><span class="nx">K</span><span class="p">]</span><span class="o">&gt;</span><span class="p">;</span>
  <span class="p">};</span>
<span class="p">};</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>另外因为修改了导出的行为， <code class="language-plaintext highlighter-rouge">main.ts</code> 也需要同步修改</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="k">import</span> <span class="p">{</span> <span class="nx">createApp</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vue</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">App</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./App.vue</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">store</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./store</span><span class="dl">'</span><span class="p">;</span>

<span class="nx">createApp</span><span class="p">(</span><span class="nx">App</span><span class="p">).</span><span class="nx">use</span><span class="p">(</span><span class="nx">store</span><span class="p">).</span><span class="nx">mount</span><span class="p">(</span><span class="dl">'</span><span class="s1">#app</span><span class="dl">'</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>状态管理部分算是完成了，我们开始编写我们的 <code class="language-plaintext highlighter-rouge">App</code> 去使用它</p>

<h1 id="app">App</h1>

<p>接下来简单改写了一下 <code class="language-plaintext highlighter-rouge">App.vue</code> 文件。首先看模板，其实就是 <code class="language-plaintext highlighter-rouge">loading</code> 的时候展示 <code class="language-plaintext highlighter-rouge">loading...</code>提示，<code class="language-plaintext highlighter-rouge">loading</code> 结束之后展示一些任务相关的信息</p>

<p>另外我们看到脚本部分，<code class="language-plaintext highlighter-rouge">Vue3</code> 和 <code class="language-plaintext highlighter-rouge">Vue2</code> 区别还是很大的，这些是 <code class="language-plaintext highlighter-rouge">Vue3</code> 里面新增的 <code class="language-plaintext highlighter-rouge">Composition Api</code></p>

<div class="language-vue highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;</span><span class="k">template</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container mx-auto mt-4"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;h1</span> <span class="na">class=</span><span class="s">"is-size-3 has-text-centered p-2 has-text-weight-bold"</span><span class="nt">&gt;</span>
      任务管理应用
    <span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">v-if=</span><span class="s">"loading"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;h3</span> <span class="na">class=</span><span class="s">"has-text-centered mt-4"</span><span class="nt">&gt;</span>Loading...<span class="nt">&lt;/h3&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">v-else</span><span class="nt">&gt;</span>
      <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">"has-text-centered mt-2"</span><span class="nt">&gt;</span>
         of  completed.
      <span class="nt">&lt;/p&gt;</span>
      <span class="c">&lt;!-- </span><span class="nt">&lt;TaskList</span> <span class="nt">/&gt;</span> --&gt;
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/</span><span class="k">template</span><span class="nt">&gt;</span>

<span class="nt">&lt;</span><span class="k">script</span> <span class="na">lang=</span><span class="s">"ts"</span><span class="nt">&gt;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">defineComponent</span><span class="p">,</span> <span class="nx">computed</span><span class="p">,</span> <span class="nx">onMounted</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vue</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">useStore</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./store</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ActionTypes</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./store/actions</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">defineComponent</span><span class="p">({</span>
  <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">App</span><span class="dl">'</span><span class="p">,</span>
  <span class="nx">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">store</span> <span class="o">=</span> <span class="nx">useStore</span><span class="p">();</span>
    <span class="kd">const</span> <span class="nx">loading</span> <span class="o">=</span> <span class="nx">computed</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">store</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">loading</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">completedCount</span> <span class="o">=</span> <span class="nx">computed</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">store</span><span class="p">.</span><span class="nx">getters</span><span class="p">.</span><span class="nx">completedTaskCount</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">totalTaskCount</span> <span class="o">=</span> <span class="nx">computed</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">store</span><span class="p">.</span><span class="nx">getters</span><span class="p">.</span><span class="nx">totalTaskCount</span><span class="p">);</span>

    <span class="nx">onMounted</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">store</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="nx">ActionTypes</span><span class="p">.</span><span class="nx">GetTaskItems</span><span class="p">));</span>

    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">loading</span><span class="p">,</span>
      <span class="nx">completedCount</span><span class="p">,</span>
      <span class="nx">totalTaskCount</span><span class="p">,</span>
    <span class="p">};</span>
  <span class="p">},</span>
<span class="p">});</span>
<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>

<span class="nt">&lt;</span><span class="k">style</span><span class="nt">&gt;</span>
<span class="k">@import</span> <span class="s2">'~bulma/css/bulma.css'</span><span class="p">;</span>
<span class="nt">&lt;/</span><span class="k">style</span><span class="nt">&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>接下来编写 <code class="language-plaintext highlighter-rouge">TaskList</code> 组件</p>

<h2 id="tasklist">TaskList</h2>

<p>先把大概的结构写出来，再慢慢补充细节上去</p>

<div class="language-vue highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;</span><span class="k">template</span><span class="nt">&gt;</span>
  <span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">"table"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;thead&gt;</span>
      <span class="nt">&lt;tr&gt;</span>
        <span class="nt">&lt;th&gt;&lt;abbr</span> <span class="na">title=</span><span class="s">"Position"</span><span class="nt">&gt;</span>Task Id<span class="nt">&lt;/abbr&gt;&lt;/th&gt;</span>
        <span class="nt">&lt;th&gt;</span>Completed<span class="nt">&lt;/th&gt;</span>
        <span class="nt">&lt;th&gt;</span>Task<span class="nt">&lt;/th&gt;</span>
        <span class="nt">&lt;th&gt;&lt;abbr</span> <span class="na">title=</span><span class="s">"Won"</span><span class="nt">&gt;</span>Created By<span class="nt">&lt;/abbr&gt;&lt;/th&gt;</span>
        <span class="nt">&lt;th&gt;&lt;abbr</span> <span class="na">title=</span><span class="s">"Drawn"</span><span class="nt">&gt;</span>Assigned To<span class="nt">&lt;/abbr&gt;&lt;/th&gt;</span>
        <span class="nt">&lt;th&gt;&lt;abbr</span> <span class="na">title=</span><span class="s">"Lost"</span><span class="nt">&gt;</span>Actions<span class="nt">&lt;/abbr&gt;&lt;/th&gt;</span>
      <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;/thead&gt;</span>
    <span class="nt">&lt;tbody</span> <span class="na">v-if=</span><span class="s">"tasks"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;template</span> <span class="na">v-for=</span><span class="s">"task in tasks"</span> <span class="na">:key=</span><span class="s">"task.id"</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- </span><span class="nt">&lt;TaskListItem</span> <span class="na">v-bind=</span><span class="s">"task"</span> <span class="nt">/&gt;</span> --&gt;
      <span class="nt">&lt;/</span><span class="k">template</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/tbody&gt;</span>
    <span class="nt">&lt;tfoot&gt;</span>
      <span class="c">&lt;!-- &lt;CreateModal v-show="showCreateModal"&gt;&lt;/CreateModal&gt; --&gt;</span>
      <span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">"button is-link"</span> <span class="err">@</span><span class="na">click=</span><span class="s">"setModal"</span><span class="nt">&gt;</span>Create Task<span class="nt">&lt;/button&gt;</span>
    <span class="nt">&lt;/tfoot&gt;</span>
  <span class="nt">&lt;/table&gt;</span>
  <span class="c">&lt;!-- &lt;EditModal v-if="showEditModal" :id="editTaskId"&gt;&lt;/EditModal&gt; --&gt;</span>
  <span class="c">&lt;!-- &lt;TaskItem v-if="showTaskModal" :id="showTaskId"&gt;&lt;/TaskItem&gt; --&gt;</span>
<span class="nt">&lt;/template&gt;</span>

<span class="nt">&lt;</span><span class="k">script</span> <span class="na">lang=</span><span class="s">"ts"</span><span class="nt">&gt;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">defineComponent</span><span class="p">,</span> <span class="nx">computed</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vue</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">useStore</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../store</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">MutationType</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@/store/mutations</span><span class="dl">'</span><span class="p">;</span>
<span class="k">export</span> <span class="k">default</span> <span class="nx">defineComponent</span><span class="p">({</span>
  <span class="nx">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">store</span> <span class="o">=</span> <span class="nx">useStore</span><span class="p">();</span>
    <span class="kd">const</span> <span class="nx">setModal</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">store</span><span class="p">.</span><span class="nx">commit</span><span class="p">(</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">SetCreateModal</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">tasks</span> <span class="o">=</span> <span class="nx">computed</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">store</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">showCreateModal</span> <span class="o">=</span> <span class="nx">computed</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">store</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">showCreateModal</span><span class="p">);</span>

    <span class="kd">const</span> <span class="nx">showEditModal</span> <span class="o">=</span> <span class="nx">computed</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">store</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">showEditModal</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">editTaskId</span> <span class="o">=</span> <span class="nx">computed</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">store</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">editModalTaskId</span><span class="p">);</span>

    <span class="kd">const</span> <span class="nx">showTaskModal</span> <span class="o">=</span> <span class="nx">computed</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">store</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">showTaskModal</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">showTaskId</span> <span class="o">=</span> <span class="nx">computed</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">store</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">showTaskId</span><span class="p">);</span>

    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">showCreateModal</span><span class="p">,</span>
      <span class="nx">setModal</span><span class="p">,</span>
      <span class="nx">tasks</span><span class="p">,</span>
      <span class="nx">showEditModal</span><span class="p">,</span>
      <span class="nx">showTaskModal</span><span class="p">,</span>
      <span class="nx">editTaskId</span><span class="p">,</span>
      <span class="nx">showTaskId</span><span class="p">,</span>
    <span class="p">};</span>
  <span class="p">},</span>
<span class="p">});</span>
<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>

<span class="nt">&lt;</span><span class="k">style</span><span class="nt">&gt;</span>
<span class="nt">table</span> <span class="p">{</span>
  <span class="nl">width</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.fa</span> <span class="p">{</span>
  <span class="nl">font-size</span><span class="p">:</span> <span class="m">1.2rem</span><span class="p">;</span>
  <span class="nl">margin-left</span><span class="p">:</span> <span class="m">15px</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.fa</span><span class="nd">:hover</span> <span class="p">{</span>
  <span class="nl">font-size</span><span class="p">:</span> <span class="m">1.4rem</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">&lt;/</span><span class="k">style</span><span class="nt">&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="tasklistitem">TaskListItem</h2>

<p>编写任务列表中每一项的组件</p>

<div class="language-vue highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;</span><span class="k">template</span><span class="nt">&gt;</span>
  <span class="nt">&lt;tr&gt;</span>
    <span class="nt">&lt;th&gt;&lt;/th&gt;</span>
    <span class="nt">&lt;td&gt;</span>
      <span class="nt">&lt;input</span>
        <span class="na">type=</span><span class="s">"checkbox"</span>
        <span class="na">:checked=</span><span class="s">"completed"</span>
        <span class="err">@</span><span class="na">change=</span><span class="s">"toggleCompletion()"</span>
      <span class="nt">/&gt;</span>
    <span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;td&gt;</span> <span class="nt">&lt;strong&gt;</span>(C)<span class="nt">&lt;/strong&gt;&lt;/td&gt;</span>
    <span class="nt">&lt;td&gt;&lt;/td&gt;</span>
    <span class="nt">&lt;td&gt;&lt;/td&gt;</span>
    <span class="nt">&lt;td&gt;</span>
      <span class="nt">&lt;span</span> <span class="err">@</span><span class="na">click=</span><span class="s">"viewTask()"</span><span class="nt">&gt;</span> View <span class="nt">&lt;/span&gt;</span>
      <span class="nt">&lt;span</span> <span class="err">@</span><span class="na">click=</span><span class="s">"editTask()"</span><span class="nt">&gt;</span> Edit <span class="nt">&lt;/span&gt;</span>
      <span class="nt">&lt;span</span> <span class="err">@</span><span class="na">click=</span><span class="s">"removeTask()"</span><span class="nt">&gt;</span> Remove <span class="nt">&lt;/span&gt;</span>
    <span class="nt">&lt;/td&gt;</span>
  <span class="nt">&lt;/tr&gt;</span>
<span class="nt">&lt;/</span><span class="k">template</span><span class="nt">&gt;</span>

<span class="nt">&lt;</span><span class="k">script</span> <span class="na">lang=</span><span class="s">"ts"</span><span class="nt">&gt;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">defineComponent</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vue</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">useStore</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../store</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">MutationType</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../store/mutations</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">defineComponent</span><span class="p">({</span>
  <span class="na">props</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">id</span><span class="p">:</span> <span class="p">{</span> <span class="na">type</span><span class="p">:</span> <span class="nb">Number</span><span class="p">,</span> <span class="na">required</span><span class="p">:</span> <span class="kc">true</span> <span class="p">},</span>
    <span class="na">title</span><span class="p">:</span> <span class="p">{</span> <span class="na">type</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="na">required</span><span class="p">:</span> <span class="kc">true</span> <span class="p">},</span>
    <span class="na">createdBy</span><span class="p">:</span> <span class="p">{</span> <span class="na">type</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="na">required</span><span class="p">:</span> <span class="kc">true</span> <span class="p">},</span>
    <span class="na">assignedTo</span><span class="p">:</span> <span class="p">{</span> <span class="na">type</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="na">required</span><span class="p">:</span> <span class="kc">true</span> <span class="p">},</span>
    <span class="na">completed</span><span class="p">:</span> <span class="p">{</span> <span class="na">type</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span> <span class="na">required</span><span class="p">:</span> <span class="kc">true</span> <span class="p">},</span>
  <span class="p">},</span>
  <span class="nx">setup</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">store</span> <span class="o">=</span> <span class="nx">useStore</span><span class="p">();</span>

    <span class="kd">const</span> <span class="nx">toggleCompletion</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">store</span><span class="p">.</span><span class="nx">commit</span><span class="p">(</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">CompleteTask</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">id</span><span class="p">:</span> <span class="nx">props</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span>
        <span class="na">completed</span><span class="p">:</span> <span class="o">!</span><span class="nx">props</span><span class="p">.</span><span class="nx">completed</span><span class="p">,</span>
      <span class="p">});</span>
    <span class="p">};</span>

    <span class="kd">const</span> <span class="nx">viewTask</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">store</span><span class="p">.</span><span class="nx">commit</span><span class="p">(</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">SetTaskModal</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">taskId</span><span class="p">:</span> <span class="nx">props</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span>
        <span class="na">showModal</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="p">});</span>
    <span class="p">};</span>

    <span class="kd">const</span> <span class="nx">removeTask</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">store</span><span class="p">.</span><span class="nx">commit</span><span class="p">(</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">RemoveTask</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">id</span><span class="p">:</span> <span class="nx">props</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span>
      <span class="p">});</span>
    <span class="p">};</span>

    <span class="kd">const</span> <span class="nx">editTask</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">store</span><span class="p">.</span><span class="nx">commit</span><span class="p">(</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">SetEditModal</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">taskId</span><span class="p">:</span> <span class="nx">props</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span>
        <span class="na">showModal</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="p">});</span>
    <span class="p">};</span>

    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">toggleCompletion</span><span class="p">,</span>
      <span class="nx">viewTask</span><span class="p">,</span>
      <span class="nx">removeTask</span><span class="p">,</span>
      <span class="nx">editTask</span><span class="p">,</span>
    <span class="p">};</span>
  <span class="p">},</span>
<span class="p">});</span>
<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="taskitem">TaskItem</h2>

<p>接下来写下点击查看任务时候的蒙层组件 <code class="language-plaintext highlighter-rouge">TaskItem</code></p>

<p>这个组件主要处理信息的展示，以及关掉弹窗的逻辑</p>

<div class="language-vue highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;</span><span class="k">template</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"modal is-active"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"modal-background"</span><span class="nt">&gt;&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"modal-content"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"card"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"card-content"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"media"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"media-content"</span><span class="nt">&gt;</span>
              <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">"title is-4"</span><span class="nt">&gt;</span>标题: <span class="nt">&lt;/p&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
          <span class="nt">&lt;/div&gt;</span>
          <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"content"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">"subtitle is-6"</span><span class="nt">&gt;&lt;b&gt;</span>分配给:<span class="nt">&lt;/b&gt;</span> <span class="nt">&lt;/p&gt;</span>
            <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">"subtitle is-6"</span><span class="nt">&gt;&lt;b&gt;</span>创建人:<span class="nt">&lt;/b&gt;</span> <span class="nt">&lt;/p&gt;</span>
            <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">"subtitle is-6"</span><span class="nt">&gt;</span>描述: <span class="nt">&lt;/p&gt;</span>
          <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;button</span>
      <span class="na">class=</span><span class="s">"modal-close is-large"</span>
      <span class="err">@</span><span class="na">click=</span><span class="s">"closeModal"</span>
      <span class="na">aria-label=</span><span class="s">"close"</span>
    <span class="nt">&gt;&lt;/button&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/</span><span class="k">template</span><span class="nt">&gt;</span>
<span class="nt">&lt;</span><span class="k">script</span> <span class="na">lang=</span><span class="s">"ts"</span><span class="nt">&gt;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">MutationType</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@/store/mutations</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">computed</span><span class="p">,</span> <span class="nx">defineComponent</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vue</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">useStore</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vuex</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">defineComponent</span><span class="p">({</span>
  <span class="na">props</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">id</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">type</span><span class="p">:</span> <span class="nb">Number</span><span class="p">,</span>
      <span class="na">required</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="p">},</span>
  <span class="p">},</span>
  <span class="nx">setup</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">store</span> <span class="o">=</span> <span class="nx">useStore</span><span class="p">();</span>
    <span class="kd">const</span> <span class="nx">task</span> <span class="o">=</span> <span class="nx">computed</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">store</span><span class="p">.</span><span class="nx">getters</span><span class="p">.</span><span class="nx">getTaskById</span><span class="p">(</span><span class="nb">Number</span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">id</span><span class="p">)));</span>

    <span class="kd">const</span> <span class="nx">closeModal</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">store</span><span class="p">.</span><span class="nx">commit</span><span class="p">(</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">SetTaskModal</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">showModal</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="na">taskId</span><span class="p">:</span> <span class="kc">undefined</span><span class="p">,</span>
      <span class="p">});</span>
    <span class="p">};</span>

    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">task</span><span class="p">,</span>
      <span class="nx">closeModal</span><span class="p">,</span>
    <span class="p">};</span>
  <span class="p">},</span>
<span class="p">});</span>
<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="createmodal">CreateModal</h2>

<p>接下来我们处理下创建任务的弹窗</p>

<p><code class="language-plaintext highlighter-rouge">...toRefs(state)</code> 可以把响应式对象的属性，平铺出来，继续保持响应式，直接在模板中使用</p>

<div class="language-vue highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;</span><span class="k">template</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"modal is-active"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"modal-background"</span><span class="nt">&gt;&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"modal-content"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"card"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"card-content"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;form</span> <span class="err">@</span><span class="na">submit.prevent=</span><span class="s">"createTask"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"field"</span><span class="nt">&gt;</span>
              <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">"label"</span><span class="nt">&gt;</span>Task Title<span class="nt">&lt;/label&gt;</span>
              <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"control"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;input</span>
                  <span class="na">v-model=</span><span class="s">"title"</span>
                  <span class="na">class=</span><span class="s">"input"</span>
                  <span class="na">type=</span><span class="s">"text"</span>
                  <span class="na">placeholder=</span><span class="s">"Enter task"</span>
                <span class="nt">/&gt;</span>
              <span class="nt">&lt;/div&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"field"</span><span class="nt">&gt;</span>
              <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">"label"</span><span class="nt">&gt;</span>Description<span class="nt">&lt;/label&gt;</span>
              <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"control"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;textarea</span>
                  <span class="na">v-model=</span><span class="s">"description"</span>
                  <span class="na">class=</span><span class="s">"textarea"</span>
                  <span class="na">placeholder=</span><span class="s">"Textarea"</span>
                <span class="nt">&gt;&lt;/textarea&gt;</span>
              <span class="nt">&lt;/div&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"field"</span><span class="nt">&gt;</span>
              <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">"label"</span><span class="nt">&gt;</span>Assigned By<span class="nt">&lt;/label&gt;</span>
              <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"control"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;input</span>
                  <span class="na">v-model=</span><span class="s">"createdBy"</span>
                  <span class="na">class=</span><span class="s">"input"</span>
                  <span class="na">type=</span><span class="s">"text"</span>
                  <span class="na">placeholder=</span><span class="s">"Enter Assigner's name"</span>
                <span class="nt">/&gt;</span>
              <span class="nt">&lt;/div&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"field"</span><span class="nt">&gt;</span>
              <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">"label"</span><span class="nt">&gt;</span>Assigned To<span class="nt">&lt;/label&gt;</span>
              <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"control"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;input</span>
                  <span class="na">v-model=</span><span class="s">"assignedTo"</span>
                  <span class="na">class=</span><span class="s">"input"</span>
                  <span class="na">type=</span><span class="s">"text"</span>
                  <span class="na">placeholder=</span><span class="s">"Enter task creator's name"</span>
                <span class="nt">/&gt;</span>
              <span class="nt">&lt;/div&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"field is-grouped"</span><span class="nt">&gt;</span>
              <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"control"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">class=</span><span class="s">"button is-link"</span><span class="nt">&gt;</span>Submit<span class="nt">&lt;/button&gt;</span>
              <span class="nt">&lt;/div&gt;</span>
              <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"control"</span> <span class="err">@</span><span class="na">click=</span><span class="s">"closeModal"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">"button is-link is-light"</span><span class="nt">&gt;</span>Cancel<span class="nt">&lt;/button&gt;</span>
              <span class="nt">&lt;/div&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
          <span class="nt">&lt;/form&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;button</span>
      <span class="na">class=</span><span class="s">"modal-close is-large"</span>
      <span class="err">@</span><span class="na">click=</span><span class="s">"closeModal"</span>
      <span class="na">aria-label=</span><span class="s">"close"</span>
    <span class="nt">&gt;&lt;/button&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/</span><span class="k">template</span><span class="nt">&gt;</span>
<span class="nt">&lt;</span><span class="k">script</span> <span class="na">lang=</span><span class="s">"ts"</span><span class="nt">&gt;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">MutationType</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@/store/mutations</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">defineComponent</span><span class="p">,</span> <span class="nx">reactive</span><span class="p">,</span> <span class="nx">toRefs</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vue</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">useStore</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vuex</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">defineComponent</span><span class="p">({</span>
  <span class="nx">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">store</span> <span class="o">=</span> <span class="nx">useStore</span><span class="p">();</span>
    <span class="kd">const</span> <span class="nx">state</span> <span class="o">=</span> <span class="nx">reactive</span><span class="p">({</span>
      <span class="na">title</span><span class="p">:</span> <span class="dl">''</span><span class="p">,</span>
      <span class="na">description</span><span class="p">:</span> <span class="dl">''</span><span class="p">,</span>
      <span class="na">createdBy</span><span class="p">:</span> <span class="dl">''</span><span class="p">,</span>
      <span class="na">assignedTo</span><span class="p">:</span> <span class="dl">''</span><span class="p">,</span>
    <span class="p">});</span>

    <span class="kd">const</span> <span class="nx">closeModal</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">store</span><span class="p">.</span><span class="nx">commit</span><span class="p">(</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">SetCreateModal</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
    <span class="p">};</span>

    <span class="kd">const</span> <span class="nx">createTask</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span>
        <span class="o">!</span><span class="nx">state</span><span class="p">.</span><span class="nx">title</span> <span class="o">||</span>
        <span class="o">!</span><span class="nx">state</span><span class="p">.</span><span class="nx">description</span> <span class="o">||</span>
        <span class="o">!</span><span class="nx">state</span><span class="p">.</span><span class="nx">createdBy</span> <span class="o">||</span>
        <span class="o">!</span><span class="nx">state</span><span class="p">.</span><span class="nx">assignedTo</span>
      <span class="p">)</span>
        <span class="k">return</span><span class="p">;</span>

      <span class="kd">const</span> <span class="nx">task</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">id</span><span class="p">:</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">(),</span>
        <span class="na">title</span><span class="p">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">title</span><span class="p">,</span>
        <span class="na">description</span><span class="p">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">description</span><span class="p">,</span>
        <span class="na">createdBy</span><span class="p">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">createdBy</span><span class="p">,</span>
        <span class="na">assignedTo</span><span class="p">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">assignedTo</span><span class="p">,</span>
        <span class="na">completed</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="na">editing</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="p">};</span>

      <span class="nx">store</span><span class="p">.</span><span class="nx">commit</span><span class="p">(</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">CreateTask</span><span class="p">,</span> <span class="nx">task</span><span class="p">);</span>
      <span class="nx">state</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>
      <span class="nx">state</span><span class="p">.</span><span class="nx">createdBy</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>
      <span class="nx">state</span><span class="p">.</span><span class="nx">assignedTo</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>
      <span class="nx">state</span><span class="p">.</span><span class="nx">description</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">state</span><span class="p">,</span>
      <span class="nx">closeModal</span><span class="p">,</span>
      <span class="nx">createTask</span><span class="p">,</span>
      <span class="p">...</span><span class="nx">toRefs</span><span class="p">(</span><span class="nx">state</span><span class="p">),</span>
    <span class="p">};</span>
  <span class="p">},</span>
<span class="p">});</span>
<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="editmodal">EditModal</h2>

<p>再来看看编辑的弹窗</p>

<div class="language-vue highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;</span><span class="k">template</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"modal is-active"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"modal-background"</span><span class="nt">&gt;&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"modal-content"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"card"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"card-content"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;form</span> <span class="err">@</span><span class="na">submit.prevent=</span><span class="s">"updateTask"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;h1&gt;</span>Edit Modal<span class="nt">&lt;/h1&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"field"</span><span class="nt">&gt;</span>
              <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">"label"</span><span class="nt">&gt;</span>Task Title<span class="nt">&lt;/label&gt;</span>
              <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"control"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;input</span>
                  <span class="na">v-model=</span><span class="s">"title"</span>
                  <span class="na">class=</span><span class="s">"input"</span>
                  <span class="na">type=</span><span class="s">"text"</span>
                  <span class="na">placeholder=</span><span class="s">"Enter task"</span>
                <span class="nt">/&gt;</span>
              <span class="nt">&lt;/div&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"field"</span><span class="nt">&gt;</span>
              <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">"label"</span><span class="nt">&gt;</span>Description<span class="nt">&lt;/label&gt;</span>
              <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"control"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;textarea</span>
                  <span class="na">v-model=</span><span class="s">"description"</span>
                  <span class="na">class=</span><span class="s">"textarea"</span>
                  <span class="na">placeholder=</span><span class="s">"Textarea"</span>
                <span class="nt">&gt;&lt;/textarea&gt;</span>
              <span class="nt">&lt;/div&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"field"</span><span class="nt">&gt;</span>
              <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">"label"</span><span class="nt">&gt;</span>Assigned By<span class="nt">&lt;/label&gt;</span>
              <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"control"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;input</span>
                  <span class="na">v-model=</span><span class="s">"createdBy"</span>
                  <span class="na">class=</span><span class="s">"input"</span>
                  <span class="na">type=</span><span class="s">"text"</span>
                  <span class="na">placeholder=</span><span class="s">"Enter Assigner's name"</span>
                <span class="nt">/&gt;</span>
              <span class="nt">&lt;/div&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"field"</span><span class="nt">&gt;</span>
              <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">"label"</span><span class="nt">&gt;</span>Assigned To<span class="nt">&lt;/label&gt;</span>
              <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"control"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;input</span>
                  <span class="na">v-model=</span><span class="s">"assignedTo"</span>
                  <span class="na">class=</span><span class="s">"input"</span>
                  <span class="na">type=</span><span class="s">"text"</span>
                  <span class="na">placeholder=</span><span class="s">"Enter task creator's name"</span>
                <span class="nt">/&gt;</span>
              <span class="nt">&lt;/div&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"field is-grouped"</span><span class="nt">&gt;</span>
              <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"control"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">class=</span><span class="s">"button is-link"</span><span class="nt">&gt;</span>Submit<span class="nt">&lt;/button&gt;</span>
              <span class="nt">&lt;/div&gt;</span>
              <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"control"</span> <span class="err">@</span><span class="na">click=</span><span class="s">"closeModal"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">"button is-link is-light"</span><span class="nt">&gt;</span>Cancel<span class="nt">&lt;/button&gt;</span>
              <span class="nt">&lt;/div&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
          <span class="nt">&lt;/form&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;button</span>
          <span class="na">class=</span><span class="s">"modal-close is-large"</span>
          <span class="err">@</span><span class="na">click=</span><span class="s">"closeModal"</span>
          <span class="na">aria-label=</span><span class="s">"close"</span>
        <span class="nt">&gt;&lt;/button&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/</span><span class="k">template</span><span class="nt">&gt;</span>
<span class="nt">&lt;</span><span class="k">script</span> <span class="na">lang=</span><span class="s">"ts"</span><span class="nt">&gt;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">useStore</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@/store</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">MutationType</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@/store/mutations</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">defineComponent</span><span class="p">,</span> <span class="nx">onMounted</span><span class="p">,</span> <span class="nx">reactive</span><span class="p">,</span> <span class="nx">toRefs</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vue</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">defineComponent</span><span class="p">({</span>
  <span class="na">props</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">id</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">type</span><span class="p">:</span> <span class="nb">Number</span><span class="p">,</span>
      <span class="na">required</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="p">},</span>
  <span class="p">},</span>
  <span class="nx">setup</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">store</span> <span class="o">=</span> <span class="nx">useStore</span><span class="p">();</span>
    <span class="kd">const</span> <span class="nx">state</span> <span class="o">=</span> <span class="nx">reactive</span><span class="p">({</span>
      <span class="na">title</span><span class="p">:</span> <span class="dl">''</span><span class="p">,</span>
      <span class="na">description</span><span class="p">:</span> <span class="dl">''</span><span class="p">,</span>
      <span class="na">createdBy</span><span class="p">:</span> <span class="dl">''</span><span class="p">,</span>
      <span class="na">assignedTo</span><span class="p">:</span> <span class="dl">''</span><span class="p">,</span>
    <span class="p">});</span>

    <span class="kd">const</span> <span class="nx">setFields</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">task</span> <span class="o">=</span> <span class="nx">store</span><span class="p">.</span><span class="nx">getters</span><span class="p">.</span><span class="nx">getTaskById</span><span class="p">(</span><span class="nb">Number</span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">id</span><span class="p">));</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">task</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="p">{</span> <span class="nx">title</span><span class="p">,</span> <span class="nx">description</span><span class="p">,</span> <span class="nx">createdBy</span><span class="p">,</span> <span class="nx">assignedTo</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">task</span><span class="p">;</span>
        <span class="nx">state</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="nx">title</span><span class="p">;</span>
        <span class="nx">state</span><span class="p">.</span><span class="nx">description</span> <span class="o">=</span> <span class="nx">description</span><span class="p">;</span>
        <span class="nx">state</span><span class="p">.</span><span class="nx">createdBy</span> <span class="o">=</span> <span class="nx">createdBy</span><span class="p">;</span>
        <span class="nx">state</span><span class="p">.</span><span class="nx">assignedTo</span> <span class="o">=</span> <span class="nx">assignedTo</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">};</span>

    <span class="kd">const</span> <span class="nx">closeModal</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">store</span><span class="p">.</span><span class="nx">commit</span><span class="p">(</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">SetEditModal</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">showModal</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="na">taskId</span><span class="p">:</span> <span class="kc">undefined</span><span class="p">,</span>
      <span class="p">});</span>
    <span class="p">};</span>

    <span class="nx">onMounted</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">setFields</span><span class="p">());</span>

    <span class="kd">const</span> <span class="nx">updateTask</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span>
        <span class="o">!</span><span class="nx">state</span><span class="p">.</span><span class="nx">title</span> <span class="o">||</span>
        <span class="o">!</span><span class="nx">state</span><span class="p">.</span><span class="nx">description</span> <span class="o">||</span>
        <span class="o">!</span><span class="nx">state</span><span class="p">.</span><span class="nx">createdBy</span> <span class="o">||</span>
        <span class="o">!</span><span class="nx">state</span><span class="p">.</span><span class="nx">assignedTo</span>
      <span class="p">)</span>
        <span class="k">return</span><span class="p">;</span>

      <span class="kd">const</span> <span class="nx">task</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">id</span><span class="p">:</span> <span class="nx">props</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span>
        <span class="na">title</span><span class="p">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">title</span><span class="p">,</span>
        <span class="na">description</span><span class="p">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">description</span><span class="p">,</span>
        <span class="na">createdBy</span><span class="p">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">createdBy</span><span class="p">,</span>
        <span class="na">assignedTo</span><span class="p">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">assignedTo</span><span class="p">,</span>
        <span class="na">completed</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="na">editing</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="p">};</span>

      <span class="nx">store</span><span class="p">.</span><span class="nx">commit</span><span class="p">(</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">UpdateTask</span><span class="p">,</span> <span class="nx">task</span><span class="p">);</span>

      <span class="nx">state</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>
      <span class="nx">state</span><span class="p">.</span><span class="nx">createdBy</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>
      <span class="nx">state</span><span class="p">.</span><span class="nx">assignedTo</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>
      <span class="nx">state</span><span class="p">.</span><span class="nx">description</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>

      <span class="nx">closeModal</span><span class="p">();</span>
    <span class="p">};</span>

    <span class="k">return</span> <span class="p">{</span>
      <span class="p">...</span><span class="nx">toRefs</span><span class="p">(</span><span class="nx">state</span><span class="p">),</span>
      <span class="nx">closeModal</span><span class="p">,</span>
      <span class="nx">updateTask</span><span class="p">,</span>
    <span class="p">};</span>
  <span class="p">},</span>
<span class="p">});</span>
<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="再续-tasklist">再续 TaskList</h2>

<p>前面注释的组件现在都补上了，所以最终组件展示成下面这样</p>

<div class="language-vue highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;</span><span class="k">template</span><span class="nt">&gt;</span>
  <span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">"table"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;thead&gt;</span>
      <span class="nt">&lt;tr&gt;</span>
        <span class="nt">&lt;th&gt;&lt;abbr</span> <span class="na">title=</span><span class="s">"Position"</span><span class="nt">&gt;</span>Task Id<span class="nt">&lt;/abbr&gt;&lt;/th&gt;</span>
        <span class="nt">&lt;th&gt;</span>Completed<span class="nt">&lt;/th&gt;</span>
        <span class="nt">&lt;th&gt;</span>Task<span class="nt">&lt;/th&gt;</span>
        <span class="nt">&lt;th&gt;&lt;abbr</span> <span class="na">title=</span><span class="s">"Won"</span><span class="nt">&gt;</span>Created By<span class="nt">&lt;/abbr&gt;&lt;/th&gt;</span>
        <span class="nt">&lt;th&gt;&lt;abbr</span> <span class="na">title=</span><span class="s">"Drawn"</span><span class="nt">&gt;</span>Assigned To<span class="nt">&lt;/abbr&gt;&lt;/th&gt;</span>
        <span class="nt">&lt;th&gt;&lt;abbr</span> <span class="na">title=</span><span class="s">"Lost"</span><span class="nt">&gt;</span>Actions<span class="nt">&lt;/abbr&gt;&lt;/th&gt;</span>
      <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;/thead&gt;</span>
    <span class="nt">&lt;tbody</span> <span class="na">v-if=</span><span class="s">"tasks"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;template</span> <span class="na">v-for=</span><span class="s">"task in tasks"</span> <span class="na">:key=</span><span class="s">"task.id"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;TaskListItem</span> <span class="na">v-bind=</span><span class="s">"task"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;/</span><span class="k">template</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/tbody&gt;</span>
    <span class="nt">&lt;tfoot&gt;</span>
      <span class="nt">&lt;CreateModal</span> <span class="na">v-show=</span><span class="s">"showCreateModal"</span><span class="nt">&gt;&lt;/CreateModal&gt;</span>
      <span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">"button is-link"</span> <span class="err">@</span><span class="na">click=</span><span class="s">"setModal"</span><span class="nt">&gt;</span>Create Task<span class="nt">&lt;/button&gt;</span>
    <span class="nt">&lt;/tfoot&gt;</span>
  <span class="nt">&lt;/table&gt;</span>
  <span class="nt">&lt;EditModal</span> <span class="na">v-if=</span><span class="s">"showEditModal"</span> <span class="na">:id=</span><span class="s">"editTaskId"</span><span class="nt">&gt;&lt;/EditModal&gt;</span>
  <span class="nt">&lt;TaskItem</span> <span class="na">v-if=</span><span class="s">"showTaskModal"</span> <span class="na">:id=</span><span class="s">"showTaskId"</span><span class="nt">&gt;&lt;/TaskItem&gt;</span>
<span class="nt">&lt;/template&gt;</span>

<span class="nt">&lt;</span><span class="k">script</span> <span class="na">lang=</span><span class="s">"ts"</span><span class="nt">&gt;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">defineComponent</span><span class="p">,</span> <span class="nx">computed</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vue</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">useStore</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../store</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">MutationType</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@/store/mutations</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">TaskListItem</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./TaskListItem.vue</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">TaskItem</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./TaskItem.vue</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">CreateModal</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./CreateModal.vue</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">EditModal</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./EditModal.vue</span><span class="dl">'</span><span class="p">;</span>
<span class="k">export</span> <span class="k">default</span> <span class="nx">defineComponent</span><span class="p">({</span>
  <span class="na">components</span><span class="p">:</span> <span class="p">{</span>
    <span class="nx">TaskListItem</span><span class="p">,</span>
    <span class="nx">TaskItem</span><span class="p">,</span>
    <span class="nx">CreateModal</span><span class="p">,</span>
    <span class="nx">EditModal</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="nx">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">store</span> <span class="o">=</span> <span class="nx">useStore</span><span class="p">();</span>
    <span class="kd">const</span> <span class="nx">setModal</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">store</span><span class="p">.</span><span class="nx">commit</span><span class="p">(</span><span class="nx">MutationType</span><span class="p">.</span><span class="nx">SetCreateModal</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">tasks</span> <span class="o">=</span> <span class="nx">computed</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">store</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">tasks</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">showCreateModal</span> <span class="o">=</span> <span class="nx">computed</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">store</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">showCreateModal</span><span class="p">);</span>

    <span class="kd">const</span> <span class="nx">showEditModal</span> <span class="o">=</span> <span class="nx">computed</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">store</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">showEditModal</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">editTaskId</span> <span class="o">=</span> <span class="nx">computed</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">store</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">editModalTaskId</span><span class="p">);</span>

    <span class="kd">const</span> <span class="nx">showTaskModal</span> <span class="o">=</span> <span class="nx">computed</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">store</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">showTaskModal</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">showTaskId</span> <span class="o">=</span> <span class="nx">computed</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">store</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">showTaskId</span><span class="p">);</span>

    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">showCreateModal</span><span class="p">,</span>
      <span class="nx">setModal</span><span class="p">,</span>
      <span class="nx">tasks</span><span class="p">,</span>
      <span class="nx">showEditModal</span><span class="p">,</span>
      <span class="nx">showTaskModal</span><span class="p">,</span>
      <span class="nx">editTaskId</span><span class="p">,</span>
      <span class="nx">showTaskId</span><span class="p">,</span>
    <span class="p">};</span>
  <span class="p">},</span>
<span class="p">});</span>
<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>

<span class="nt">&lt;</span><span class="k">style</span><span class="nt">&gt;</span>
<span class="nt">table</span> <span class="p">{</span>
  <span class="nl">width</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">&lt;/</span><span class="k">style</span><span class="nt">&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="结语">结语</h2>

<p>这篇文章整理自 <a href="https://soshace.com/building-web-apps-with-vue-3-composition-api-typescript-vuex4-0/">Building Web Apps with Vue 3 composition API + Typescript + Vuex(4.0)</a></p>

<p>过程也发现了原来的文章展示出来的代码有一些问题，在学习的过程中进行了修改，保证案例可正常运行～</p>

<p>over ~</p>


        <hr style="visibility: hidden;" />
        <ul class="pager">
          
          <li class="previous">
            <a
              href="/Blog/2021/03/20/vue-cli-github-pages/"
              data-toggle="tooltip"
              data-placement="top"
              title="Vue CLI 项目使用 Github Pages 自动部署静态页面"
            >
              Previous<br />
              <span>Vue CLI 项目使用 Github Pages 自动部署静态页面</span>
            </a>
          </li>
           
          <li class="next">
            <a
              href="/Blog/2021/03/21/browser-working-principle-http/"
              data-toggle="tooltip"
              data-placement="top"
              title="《浏览器工作原理与实践》系列笔记 - 浏览器中的网络"
            >
              Next<br />
              <span>《浏览器工作原理与实践》系列笔记 - 浏览器中的网络</span>
            </a>
          </li>
          
        </ul>
        <hr style="visibility: hidden;" />

        
        <!-- disqus 评论框 start -->
        <div class="comment">
          <div id="disqus_thread" class="disqus-thread"></div>
        </div>
        <!-- disqus 评论框 end -->
         
      </div>

      <!-- Side Catalog Container -->
      
      <div
        class="col-lg-2 col-lg-offset-0 visible-lg-block sidebar-container catalog-container"
      >
        <div class="side-catalog">
          <hr class="hidden-sm hidden-xs" />
          <h5>
            <a class="catalog-toggle" href="#">CATALOG</a>
          </h5>
          <ul class="catalog-body"></ul>
        </div>
      </div>
      

      <!-- Sidebar Container -->
      <div
        class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 sidebar-container"
      >
        <!-- Featured Tags -->
        


<section>
    
        <hr class="hidden-sm hidden-xs">
    
    <h5><a href="/Blog/archive/">FEATURED TAGS</a></h5>
    <div class="tags">
        
        
        
        
        
        
                <a data-sort="0074" 
                    href="/Blog/archive/?tag=Regular"
                    title="Regular"
                    rel="4">Regular</a>
        
                <a data-sort="0038" 
                    href="/Blog/archive/?tag=LeetCode"
                    title="LeetCode"
                    rel="40">LeetCode</a>
        
                <a data-sort="0068" 
                    href="/Blog/archive/?tag=Process"
                    title="Process"
                    rel="10">Process</a>
        
                <a data-sort="0071" 
                    href="/Blog/archive/?tag=browser"
                    title="browser"
                    rel="7">browser</a>
        
                <a data-sort="0076" 
                    href="/Blog/archive/?tag=JavaScript"
                    title="JavaScript"
                    rel="2">JavaScript</a>
        
                <a data-sort="0076" 
                    href="/Blog/archive/?tag=Performance"
                    title="Performance"
                    rel="2">Performance</a>
        
                <a data-sort="0076" 
                    href="/Blog/archive/?tag=V8"
                    title="V8"
                    rel="2">V8</a>
        
                <a data-sort="0076" 
                    href="/Blog/archive/?tag=Vue"
                    title="Vue"
                    rel="2">Vue</a>
        
                <a data-sort="0076" 
                    href="/Blog/archive/?tag=life"
                    title="life"
                    rel="2">life</a>
    </div>
</section>


        <!-- Friends Blog -->
        
      </div>
    </div>
  </div>
</article>

<!-- add support for mathjax by voleking-->
  
<!-- disqus 公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES * * */
  var disqus_shortname = "cody1991-blog";
  var disqus_identifier = "/2021/03/20/vue3-ts-list";
  var disqus_url = "https://cody1991.github.io/Blog/2021/03/20/vue3-ts-list/";

  (function () {
    var dsq = document.createElement("script");
    dsq.type = "text/javascript";
    dsq.async = true;
    dsq.src = "//" + disqus_shortname + ".disqus.com/embed.js";
    (
      document.getElementsByTagName("head")[0] ||
      document.getElementsByTagName("body")[0]
    ).appendChild(dsq);
  })();
</script>
<!-- disqus 公共JS代码 end -->
 
<!-- async load function -->
<script>
  function async(u, c) {
    var d = document,
      t = "script",
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) {
      o.addEventListener(
        "load",
        function (e) {
          c(null, e);
        },
        false
      );
    }
    s.parentNode.insertBefore(o, s);
  }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
  async(
    "//cdn.bootcdn.net/ajax/libs/anchor-js/1.1.1/anchor.min.js",
    function () {
      anchors.options = {
        visible: "hover",
        placement: "right",
        // icon: '#'
      };
      anchors
        .add()
        .remove(".intro-header h1")
        .remove(".subheading")
        .remove(".sidebar-container h5");
    }
  );
</script>
<style>
  /* place left on bigger screen */
  @media all and (min-width: 800px) {
    .anchorjs-link {
      position: absolute;
      left: -0.75em;
      font-size: 1.1em;
      margin-top: -0.1em;
    }
  }
</style>

 <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <!-- SNS Link -->
                


<ul class="list-inline text-center">


  
  
  <li>
    <a href="https://twitter.com/cody19910828">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
      </span>
    </a>
  </li>
  
  
  <li>
    <a target="_blank" href="https://www.zhihu.com/people/cody1991">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa  fa-stack-1x fa-inverse">知</i>
      </span>
    </a>
  </li>
  
  
  <li>
    <a target="_blank" href="http://weibo.com/cody1991">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
      </span>
    </a>
  </li>
  
  
  <li>
    <a target="_blank" href="https://www.facebook.com/zexiong.tang">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
      </span>
    </a>
  </li>
  
  
  <li>
    <a target="_blank" href="https://github.com/cody1991">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa fa-github fa-stack-1x fa-inverse"></i>
      </span>
    </a>
  </li>
  
  
</ul>

                <p class="copyright text-muted">
                    Copyright &copy; cody1991 2021
                    <br>
                    Powered by <a href="http://huangxuan.me">Hux Blog</a>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="//cdn.bootcdn.net/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<!-- Currently, only navbar scroll-down effect at desktop still depends on this -->
<script src="//cdn.bootcdn.net/ajax/libs/twitter-bootstrap/3.3.2/js/bootstrap.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="/Blog/js/hux-blog.min.js "></script>

<!-- Simple Jekyll Search -->
<script src="//cdn.bootcdn.net/ajax/libs/simple-jekyll-search/1.7.12/simple-jekyll-search.min.js"></script>

<!-- Service Worker -->

<script src="/Blog/js/snackbar.js "></script>
<script src="/Blog/js/sw-registration.js "></script>


<!-- async load function -->
<script>
    function async(u, c) {
        var d = document, t = 'script',
            o = d.createElement(t),
            s = d.getElementsByTagName(t)[0];
        o.src = u;
        if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
        s.parentNode.insertBefore(o, s);
    }
</script>

<!--
     Because of the native support for backtick-style fenced code blocks
     right within the Markdown is landed in Github Pages,
     From V1.6, There is no need for Highlight.js,
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/
     - https://github.com/jneen/rouge/wiki/list-of-supported-languages-and-lexers
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->







<!--fastClick.js -->
<script>
    async("//cdn.bootcdn.net/ajax/libs/fastclick/1.0.6/fastclick.min.js", function () {
        var $nav = document.querySelector("nav");
        if ($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->



<!-- Baidu Tongji -->



<!-- Side Catalog -->

<script type="text/javascript">
    function generateCatalog(selector) {

        // interop with multilangual 
        if ('' == 'true') {
            _containerSelector = 'div.post-container.active'
        } else {
            _containerSelector = 'div.post-container'
        }

        // init
        var P = $(_containerSelector), a, n, t, l, i, c;
        a = P.find('h1,h2,h3,h4,h5,h6');

        // clean
        $(selector).html('')

        // appending
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            i = "#" + $(this).prop('id');
            t = $(this).text();
            c = $('<a href="' + i + '" rel="nofollow">' + t + '</a>');
            l = $('<li class="' + n + '_nav"></li>').append(c);
            $(selector).append(l);
        });
        return true;
    }

    generateCatalog(".catalog-body");

    // toggle side catalog
    $(".catalog-toggle").click((function (e) {
        e.preventDefault();
        $('.side-catalog').toggleClass("fold")
    }))

    /*
     * Doc: https://github.com/davist11/jQuery-One-Page-Nav
     * Fork by Hux to support padding
     */
    async("//cdn.bootcdn.net/ajax/libs/jquery-one-page-nav/3.0.0/jquery.nav.min.js", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            changeHash: !1,
            easing: "swing",
            filter: "",
            scrollSpeed: 700,
            scrollOffset: 0,
            scrollThreshold: .2,
            begin: null,
            end: null,
            scrollChange: null,
            padding: 80
        });
    });
</script>



<!-- Multi-Lingual -->


<!-- Simple Jekyll Search -->
<script>
    // https://stackoverflow.com/questions/1912501/unescape-html-entities-in-javascript
    function htmlDecode(input) {
        var e = document.createElement('textarea');
        e.innerHTML = input;
        // handle case of empty input
        return e.childNodes.length === 0 ? "" : e.childNodes[0].nodeValue;
    }

    SimpleJekyllSearch({
        searchInput: document.getElementById('search-input'),
        resultsContainer: document.getElementById('search-results'),
        json: '/Blog' + '/search.json',
        searchResultTemplate: '<div class="post-preview item"><a href="{url}"><h2 class="post-title">{title}</h2><h3 class="post-subtitle">{subtitle}</h3><hr></a></div>',
        noResultsText: 'No results',
        limit: 50,
        fuzzy: false,
        // a hack to get escaped subtitle unescaped. for some reason, 
        // post.subtitle w/o escape filter nuke entire search.
        templateMiddleware: function (prop, value, template) {
            if (prop === 'subtitle' || prop === 'title') {
                if (value.indexOf("code")) {
                    return htmlDecode(value);
                } else {
                    return value;
                }
            }
        }
    });

    $(document).ready(function () {
        var $searchPage = $('.search-page');
        var $searchOpen = $('.search-icon');
        var $searchClose = $('.search-icon-close');
        var $searchInput = $('#search-input');
        var $body = $('body');

        $searchOpen.on('click', function (e) {
            e.preventDefault();
            $searchPage.toggleClass('search-active');
            var prevClasses = $body.attr('class') || '';
            setTimeout(function () {
                $body.addClass('no-scroll');
            }, 400)

            if ($searchPage.hasClass('search-active')) {
                $searchClose.on('click', function (e) {
                    e.preventDefault();
                    $searchPage.removeClass('search-active');
                    $body.attr('class', prevClasses);  // from closure 
                });
                $searchInput.focus();
            }
        });
    });
</script>

    <!-- Image to hack wechat -->
    <img
      src="/Blog/img/icon_wechat.png"
      width="0"
      height="0"
    />
    <!-- Migrate from head to bottom, no longer block render and still work -->
  </body>
</html>
